# Generated API Services

This directory contains auto-generated TypeScript API client code from the OpenAPI specification.

## Regenerating the API Code

To regenerate the API services after updating `openapi.json`, run:

```bash
pnpm run openapi
```

## Configuration

The API base URL is **automatically configured** from environment variables. You don't need to manually configure it!

### Environment Variables

Create a `.env` file in the project root:

```bash
# API Configuration
UMI_APP_API_BASE_URL=http://localhost:8080
```

The configuration is automatically initialized in `src/app.tsx` at app startup.

### Manual Configuration (Advanced)

If you need to dynamically change the API URL at runtime:

```typescript
import { setApiBaseUrl, getApiBaseUrl } from '@/config/api';

// Change the API URL dynamically
setApiBaseUrl('https://new-api-url.com');

// Get the current API URL
const currentUrl = getApiBaseUrl();
```

**Important**: Never modify `src/services/core/OpenAPI.ts` directly, as it gets regenerated by `openapi-typescript-codegen`.

For more details, see [ENV_SETUP.md](../../ENV_SETUP.md)

## Usage Examples

### Import and Use Services

```typescript
import {
  AccountServiceService,
  SuperAdminServiceService,
  PresetThemeServiceService,
} from '@/services';

// Example: Sign in
async function signIn() {
  try {
    const response = await AccountServiceService.accountServiceSignInByEmail({
      email: 'admin@example.com',
      password: 'password123',
    });
    console.log('Sign in successful:', response);
  } catch (error) {
    console.error('Sign in failed:', error);
  }
}

// Example: List super admins
async function listAdmins() {
  try {
    const response =
      await SuperAdminServiceService.superAdminServiceListSuperAdmin({
        page: 1,
        page_size: 10,
      });
    console.log('Admins:', response.data?.super_admins);
  } catch (error) {
    console.error('Failed to list admins:', error);
  }
}

// Example: Create preset theme
async function createTheme() {
  try {
    const response =
      await PresetThemeServiceService.presetThemeServiceCreatePresetTheme({
        name: 'Dark Theme',
        description: 'A beautiful dark theme',
        category: 'dark',
        primary_color: '#1890ff',
        accent_color: '#52c41a',
        published: true,
      });
    console.log('Theme created with ID:', response.data?.id);
  } catch (error) {
    console.error('Failed to create theme:', error);
  }
}
```

### Using with React Components

```typescript
import { useEffect, useState } from 'react';
import { SuperAdminServiceService, type SuperAdminInfo } from '@/services';

function AdminList() {
  const [admins, setAdmins] = useState<SuperAdminInfo[]>([]);
  const [loading, setLoading] = useState(false);

  useEffect(() => {
    async function fetchAdmins() {
      setLoading(true);
      try {
        const response =
          await SuperAdminServiceService.superAdminServiceListSuperAdmin({
            page: 1,
            page_size: 20,
          });
        setAdmins(response.data?.super_admins || []);
      } catch (error) {
        console.error('Failed to fetch admins:', error);
      } finally {
        setLoading(false);
      }
    }

    fetchAdmins();
  }, []);

  if (loading) return <div>Loading...</div>;

  return (
    <ul>
      {admins.map((admin) => (
        <li key={admin.id}>
          {admin.name} - {admin.email}
        </li>
      ))}
    </ul>
  );
}
```

## Available Services

- **AccountServiceService**: User authentication operations

  - `accountServiceRefreshToken()` - Refresh authentication token
  - `accountServiceSignInByEmail()` - Sign in with email
  - `accountServiceSignOut()` - Sign out

- **SuperAdminServiceService**: Super admin management

  - `superAdminServiceCreateSuperAdmin()` - Create a new super admin
  - `superAdminServiceDeleteSuperAdmin()` - Delete a super admin
  - `superAdminServiceGetSuperAdmin()` - Get super admin details
  - `superAdminServiceListSuperAdmin()` - List all super admins
  - `superAdminServiceUpdateSuperAdmin()` - Update super admin info

- **PresetThemeServiceService**: Theme management
  - `presetThemeServiceCreatePresetTheme()` - Create a new theme
  - `presetThemeServiceDeletePresetTheme()` - Delete a theme
  - `presetThemeServiceGetPresetTheme()` - Get theme details
  - `presetThemeServiceListPresetThemes()` - List all themes
  - `presetThemeServiceUpdatePresetTheme()` - Update theme

## Type Safety

All request and response types are fully typed. Import them as needed:

```typescript
import type {
  SignInByEmailReqBody,
  SignInByEmailRespBody,
  SuperAdminInfo,
  PresetThemeInfo,
  // ... other types
} from '@/services';
```

## Error Handling

The services throw `ApiError` on failures. Always wrap API calls in try-catch:

```typescript
import { ApiError } from '@/services';

try {
  const result = await AccountServiceService.accountServiceSignInByEmail(data);
} catch (error) {
  if (error instanceof ApiError) {
    console.error('API Error:', error.status, error.message);
  }
}
```
